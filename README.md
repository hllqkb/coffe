# 咖啡庄园小程序

一个基于微信小程序的虚拟咖啡种植游戏，用户可以免费认领咖啡树、通过签到和付费获得道具、观看咖啡树成长过程、学习咖啡知识，并在收获后免费品尝真实咖啡豆。

## 🌟 主要功能

### 🌱 虚拟咖啡种植
- **免费认领**：用户可以免费认领虚拟咖啡树苗
- **品种选择**：支持阿拉比卡、罗布斯塔、利比里卡、埃克塞尔萨四种咖啡品种
- **成长阶段**：种子期 → 发芽期 → 幼苗期 → 开花期 → 结果期 → 成熟期
- **实时照片**：展示真实咖啡庄园提供的成长照片

### 💧 养护系统
- **浇水施肥**：通过消耗道具来促进咖啡树成长
- **健康监控**：实时监测咖啡树的健康状态
- **成长记录**：详细记录每次操作和成长变化

### 🎁 获取道具
- **每日签到**：连续签到获得水滴、肥料、金币奖励
- **任务系统**：完成各种任务获得额外奖励
- **道具商店**：使用金币购买各种道具和工具
- **套餐优惠**：提供多种超值套餐选择

### 📚 咖啡知识
- **视频教学**：专业咖啡知识视频内容
- **文章阅读**：深度咖啡文化和种植知识
- **问答互动**：专家答疑和用户交流
- **分类学习**：按主题分类的知识体系

### 🏆 社交互动
- **评论系统**：在咖啡树和知识内容下互动交流
- **成就系统**：完成各种挑战解锁成就徽章
- **好友邀请**：邀请好友一起种植咖啡树
- **分享功能**：分享成长过程到朋友圈

### ☕ 实物奖励
- **免费邮寄**：咖啡树成熟后免费邮寄咖啡豆品尝
- **地址管理**：支持多个收货地址管理
- **物流跟踪**：实时跟踪咖啡豆邮寄状态

## 🛠 技术栈

### 前端
- **框架**：微信小程序原生开发
- **样式**：WXSS + CSS3 动画
- **组件**：自定义组件 + 微信原生组件
- **状态管理**：全局数据管理

### 后端
- **云开发**：微信云开发平台
- **云函数**：Node.js 云函数
  - **云数据库**：NoSQL 文档数据库

- **云存储**：图片和文件存储

### 数据库设计
- **users**：用户信息表
- **coffee_trees**：咖啡树信息表
- **checkin_records**：签到记录表
- **user_achievements**：用户成就表
- **knowledge_content**：知识内容表
- **comments**：评论表
- **orders**：订单表
- **addresses**：地址表

## 📱 页面结构

```
├── pages/
│   ├── index/              # 首页
│   ├── garden/             # 我的庄园
│   ├── knowledge/          # 咖啡知识
│   ├── checkin/            # 每日签到
│   ├── shop/               # 道具商店
│   └── profile/            # 个人中心
├── components/             # 自定义组件
├── utils/                  # 工具函数
├── images/                 # 图片资源
└── cloudfunctions/         # 云函数
    ├── userLogin/          # 用户登录
    ├── coffeeTreeManager/  # 咖啡树管理
    └── checkinManager/     # 签到管理
```

## 🚀 快速开始

### 环境要求
- 微信开发者工具
- Node.js 12.x 或更高版本
- 微信小程序账号
- 微信云开发环境

### 安装步骤

1. **克隆项目**
```bash
git clone [项目地址]
cd coffe
```

2. **配置小程序**
- 在微信开发者工具中导入项目
- 修改 `project.config.json` 中的 `appid`
- 配置云开发环境 ID

3. **部署云函数**
```bash
# 在微信开发者工具中右键云函数目录
# 选择"上传并部署：云端安装依赖"
```

4. **初始化数据库**
- 在云开发控制台创建数据库集合
- 配置数据库权限
- 导入初始数据（可选）

5. **配置云存储**
- 设置云存储权限
- 上传默认图片资源

### 开发调试

1. **本地调试**
- 在微信开发者工具中打开项目
- 启用云开发调试
- 选择云开发环境

2. **真机预览**
- 点击预览按钮生成二维码
- 使用微信扫码在真机上测试

## 📋 功能清单

### ✅ 已完成功能
- [x] 用户登录注册系统
- [x] 咖啡树种植和管理
- [x] 每日签到系统
- [x] 道具商店
- [x] 咖啡知识展示
- [x] 个人中心
- [x] 成就系统
- [x] 评论互动

### 🚧 开发中功能
- [ ] 实物邮寄系统
- [ ] 支付功能集成
- [ ] 推送通知
- [ ] 数据统计分析

### 📝 计划功能
- [ ] 好友系统
- [ ] 排行榜
- [ ] 活动系统
- [ ] 客服系统

## 🎯 核心云函数

### userLogin
处理用户登录、注册和基础信息管理

### coffeeTreeManager
管理咖啡树的种植、浇水、施肥、收获等操作

### checkinManager
处理用户签到、奖励发放和签到记录

## 📊 数据流程

1. **用户注册流程**
   - 微信授权登录
   - 创建用户记录
   - 初始化资源和成就

2. **咖啡树种植流程**
   - 选择咖啡品种
   - 创建咖啡树记录
   - 开始成长计时

3. **签到奖励流程**
   - 检查签到状态
   - 计算奖励数量
   - 更新用户资源

## 🔧 配置说明

### 云开发环境配置
```javascript
// app.js
wx.cloud.init({
  env: 'your-env-id', // 云开发环境 ID
  traceUser: true
});
```

### 数据库权限配置
- users: 仅创建者可读写
- coffee_trees: 仅创建者可读写
- checkin_records: 仅创建者可读写
- knowledge_content: 所有用户可读，管理员可写
- comments: 所有用户可读写

## 🐛 常见问题

### Q: 云函数调用失败
A: 检查云开发环境是否正确配置，确保云函数已正确部署

### Q: 图片显示不出来
A: 检查云存储权限设置，确保图片路径正确

### Q: 签到功能异常
A: 检查系统时间和时区设置，确保日期计算正确

## 📄 许可证

MIT License

## 🤝 贡献指南

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

## 📞 联系我们

- 项目维护者：hllqk
- 邮箱：hllqkb@gmail.com
- 微信：hllqkb

## 🙏 致谢

感谢所有为这个项目做出贡献的开发者和咖啡庄园主们！

---

**注意**：本项目仅供学习和交流使用，商业使用请联系作者获得授权。